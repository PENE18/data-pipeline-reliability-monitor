FROM bitnami/spark:3.5.1-debian-12-r2

USER root

# Install Python dependencies
RUN pip install --no-cache-dir pyspark==3.5.0 psycopg2-binary

# Create directories
RUN mkdir -p /opt/spark/jobs /opt/spark/data

# Download PostgreSQL JDBC driver
RUN curl -L https://jdbc.postgresql.org/download/postgresql-42.6.0.jar \
    -o /opt/bitnami/spark/jars/postgresql-42.6.0.jar

WORKDIR /opt/spark
USER 1001
